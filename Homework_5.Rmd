---
title: 'Homework #5'
author: "Alex Alon"
date: "2024-10-21"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'Data')
```

Due date: Nov. 18 by midnight

Continue using the dataset used for Homework #4. 
You will submit this project by sending me the link to a GitHub repository.
For the write-up of this homework, youâ€™ll need to write an RMarkdown document and render it to a pdf file within the R Project for the GitHub repository.

As you work on your homework, make sure you commit regularly (with helpful commit messages). You should have at least 15 commit messages in your history for the repo by the time you turn in the homework.

Select one of the following two figures to create for the homework:

Choice 1: Create a map showing the locations of the homicides in that city, using the sf framework discussed in class. Use tigris to download boundaries for some sub-city geography (e.g., tracts, block groups, county subdivisions) to show as a layer underneath the points showing homicides. Use different facets for solved versus unsolved homicides and different colors to show the three race groups with the highest number of homicides for that city (you may find the fct_lump function from forcats useful for this).




```{r}
library(tidyverse)
library(purrr)
library(ggplot2)
library(broom)
library(tigris)

homicides <- read.csv('homicide-data.csv')

homicides <- homicides %>%
  mutate(state = replace(state, state == "wI", "WI")) %>%
  mutate('city_name' =  paste(homicides$city, homicides$state, sep = ", "))

#group_by city
#sum of unsolved homicides
unsolved <- homicides %>%
  group_by(city_name) %>%
  mutate("unsolved_homicides" = disposition %in% c("Closed without arrest", "Open/No arrest")) %>%
  summarize(total_homicides = n(), total_unsolved = sum(unsolved_homicides)) 


#I'm most interested in Los Angeles

LA <- homicides %>%
  filter(city_name == "Los Angeles, CA")

la_subdivisions <- county_subdivisions(state = "CA", county = "Los Angeles", cb = TRUE, class = "sf")
```


