---
title: 'Homework #5'
author: "Alex Alon"
date: "2024-10-21"
output: word_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'Data')
```

Due date: Nov. 18 by midnight

Continue using the dataset used for Homework #4. You will submit this
project by sending me the link to a GitHub repository. For the write-up
of this homework, you'll need to write an RMarkdown document and render
it to a pdf file within the R Project for the GitHub repository.

As you work on your homework, make sure you commit regularly (with
helpful commit messages). You should have at least 15 commit messages in
your history for the repo by the time you turn in the homework.

```{r}
library(tidyverse)
library(purrr)
library(ggplot2)
library(broom)
library(tigris)
library(maps)
library(sf)

homicides <- read.csv('homicide-data.csv')

homicides <- homicides %>%
  mutate(state = replace(state, state == "wI", "WI")) %>%
  mutate('city_name' =  paste(homicides$city, homicides$state, sep = ", "))

#group_by city
#sum of unsolved homicides
unsolved <- homicides %>%
  group_by(city_name) %>%
  mutate("unsolved_homicides" = disposition %in% c("Closed without arrest", "Open/No arrest"))


#I'm most interested in Los Angeles

LA <- unsolved %>%
  filter(city_name == "Los Angeles, CA")

us_states <- data.frame(state= state.name, area = state.area, region = state.region)

la_subdivisions <- county_subdivisions(state = "CA", county = "Los Angeles", cb = TRUE, class = "sf")

la_blocks <- block_groups(state = "CA", county = "Los Angeles", cb = TRUE, class = "sf")

la_tracts <- tracts(state = "CA", county = "Los Angeles", cb = TRUE, class = "sf")

la_county <- counties(state = "CA", cb = TRUE, class = "sf") %>%
  filter(NAME=="Los Angeles")

LA <- st_as_sf(LA, coords = c("lon", "lat"))%>% 
  st_set_crs(4269) %>%
  filter(victim_race %in% c("White", "Black", "Hispanic"))

top3_race <- LA %>%
  group_by(victim_race) %>%
  count()

ggplot() +
  geom_sf(data =la_county, color = 'black', 
          aes(fill = NA)) +
  geom_sf(data =la_subdivisions,  color = 'black', 
          aes(fill = NA)) +
  geom_sf(data =la_blocks,  color = 'black', 
          aes(fill = NA))  +
  geom_sf(data =la_tracts,  color = 'black', 
          aes(fill = NA)) +
  geom_sf(data=LA,  aes(color = victim_race)) +
  facet_wrap(~unsolved_homicides)
```